# 财务指标体系设计

## 📊 指标分类

支持后续交叉计算，涵盖三大报表 + 计算指标

---

## 1. 损益表指标（Income Statement）

### 1.1 收入类（Revenue）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| revenue | 营业收入 | 总收入 | 规模、增长分析 |
| revenue_yoy | 营收同比增长率 | (本期-去年同期)/去年同期 | 成长性 |
| revenue_qoq | 营收环比增长率 | (本期-上期)/上期 | 季节性分析 |
| revenue_cagr_3y | 营收3年复合增长率 | 计算得出 | 长期成长性 |

### 1.2 成本和利润类（Cost & Profit）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| operating_cost | 营业成本 | 直接成本 | 毛利计算 |
| operating_profit | 营业利润 | 营业收入-营业成本-费用 | 核心盈利能力 |
| total_profit | 利润总额 | 营业利润+营业外收支 | 税前盈利 |
| net_profit | 净利润 | 归属母公司净利润 | 最终盈利 |
| net_profit_yoy | 净利润同比增长率 | - | 盈利增长性 |
| net_profit_qoq | 净利润环比增长率 | - | 季节性分析 |
| net_profit_cagr_3y | 净利润3年复合增长率 | 计算得出 | 长期盈利增长 |

### 1.3 费用类（Expenses）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| selling_expense | 销售费用 | - | 费用结构分析 |
| admin_expense | 管理费用 | - | 费用结构分析 |
| finance_expense | 财务费用 | - | 债务成本 |
| rd_expense | 研发费用 | - | 创新投入 |
| tax_expense | 所得税费用 | - | 税负分析 |

### 1.4 每股指标（Per Share）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| eps | 每股收益 | 净利润/总股本 | 估值基础 |
| eps_diluted | 摊薄每股收益 | 考虑稀释 | 保守估值 |
| bps | 每股净资产 | 净资产/总股本 | 安全边际 |

### 1.5 利润率指标（Margin）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| gross_margin | 毛利率 | (收入-成本)/收入 | 定价能力 |
| operating_margin | 营业利润率 | 营业利润/收入 | 运营效率 |
| net_margin | 净利率 | 净利润/收入 | 最终盈利能力 |
| ebitda_margin | EBITDA利润率 | EBITDA/收入 | 现金盈利能力 |

---

## 2. 资产负债表指标（Balance Sheet）

### 2.1 资产类（Assets）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| total_assets | 总资产 | 全部资产 | 规模 |
| current_assets | 流动资产 | 1年内变现 | 短期偿债 |
| non_current_assets | 非流动资产 | 长期资产 | 重资产程度 |
| cash_and_equivalents | 货币资金 | 现金+现金等价物 | 流动性 |
| accounts_receivable | 应收账款 | - | 回款能力 |
| inventory | 存货 | - | 周转效率 |
| fixed_assets | 固定资产 | - | 资本密集度 |
| intangible_assets | 无形资产 | - | 轻资产程度 |
| goodwill | 商誉 | - | 并购风险 |

### 2.2 负债类（Liabilities）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| total_liabilities | 总负债 | 全部负债 | 偿债压力 |
| current_liabilities | 流动负债 | 1年内到期 | 短期压力 |
| non_current_liabilities | 非流动负债 | 长期负债 | 长期债务 |
| short_term_borrowing | 短期借款 | - | 资金链 |
| long_term_borrowing | 长期借款 | - | 债务结构 |
| accounts_payable | 应付账款 | - | 议价能力 |

### 2.3 权益类（Equity）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| total_equity | 股东权益 | 净资产 | 安全边际 |
| share_capital | 股本 | - | 股本结构 |
| retained_earnings | 未分配利润 | - | 利润留存 |

### 2.4 财务结构比率（Structure Ratios）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| asset_liability_ratio | 资产负债率 | 总负债/总资产 | 杠杆水平 |
| debt_to_equity | 产权比率 | 总负债/股东权益 | 财务风险 |
| equity_multiplier | 权益乘数 | 总资产/股东权益 | 杠杆倍数 |
| current_ratio | 流动比率 | 流动资产/流动负债 | 短期偿债 |
| quick_ratio | 速动比率 | (流动资产-存货)/流动负债 | 快速偿债 |
| cash_ratio | 现金比率 | 现金/流动负债 | 即时偿债 |

---

## 3. 现金流量表指标（Cash Flow）

### 3.1 三大现金流（Cash Flows）
| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| operating_cash_flow | 经营活动现金流 | 主营业务现金流 | 造血能力 |
| investing_cash_flow | 投资活动现金流 | 资本支出 | 扩张投入 |
| financing_cash_flow | 筹资活动现金流 | 融资/还债 | 资金来源 |
| net_cash_flow | 现金流量净额 | 三大流量合计 | 现金变化 |

### 3.2 自由现金流（Free Cash Flow）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| free_cash_flow | 自由现金流 | 经营现金流-资本支出 | 可分配现金 |
| fcf_per_share | 每股自由现金流 | FCF/总股本 | 分红能力 |
| fcf_to_revenue | FCF/收入比 | FCF/营业收入 | 现金转化率 |

### 3.3 现金流质量（CF Quality）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| ocf_to_net_profit | 经营现金/净利润 | 经营现金流/净利润 | 盈利质量 |
| capex_to_ocf | 资本支出/经营现金流 | 资本支出/经营现金流 | 再投资需求 |

---

## 4. 盈利能力指标（Profitability）

| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| roe | 净资产收益率 | 净利润/平均净资产 | 核心指标 |
| roa | 总资产收益率 | 净利润/平均总资产 | 资产效率 |
| roic | 投入资本回报率 | NOPAT/(总资产-无息流动负债) | 资本效率 |
| roc | 资本回报率 | EBIT/(股东权益+长期负债) | 核心竞争力 |

---

## 5. 运营效率指标（Efficiency）

### 5.1 周转率（Turnover）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| asset_turnover | 总资产周转率 | 收入/平均总资产 | 资产效率 |
| inventory_turnover | 存货周转率 | 成本/平均存货 | 库存管理 |
| receivable_turnover | 应收账款周转率 | 收入/平均应收 | 回款速度 |
| payable_turnover | 应付账款周转率 | 成本/平均应付 | 付款周期 |

### 5.2 周转天数（Days）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| inventory_days | 存货周转天数 | 365/存货周转率 | 库存占用 |
| receivable_days | 应收账款天数 | 365/应收周转率 | 回款周期 |
| payable_days | 应付账款天数 | 365/应付周转率 | 付款周期 |
| cash_conversion_cycle | 现金周转周期 | 存货天数+应收天数-应付天数 | 资金占用 |

---

## 6. 估值指标（Valuation）

| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| pe_ratio | 市盈率（PE） | 股价/EPS | 相对估值 |
| pb_ratio | 市净率（PB） | 股价/BPS | 安全边际 |
| ps_ratio | 市销率（PS） | 市值/营收 | 收入估值 |
| pcf_ratio | 市现率（PCF） | 市值/经营现金流 | 现金流估值 |
| peg_ratio | PEG | PE/净利润增长率 | 成长性估值 |
| ev_to_ebitda | EV/EBITDA | 企业价值/EBITDA | 并购估值 |

---

## 7. 成长性指标（Growth）

| 字段名 | 中文名 | 说明 | 用途 |
|--------|--------|------|------|
| revenue_growth_3y | 营收3年增长率 | - | 长期增长 |
| profit_growth_3y | 利润3年增长率 | - | 长期增长 |
| asset_growth_yoy | 总资产同比增长 | - | 规模扩张 |
| equity_growth_yoy | 净资产同比增长 | - | 内生增长 |

---

## 8. 其他重要指标（Others）

### 8.1 研发和创新（R&D）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| rd_ratio | 研发费用率 | 研发费用/营收 | 创新投入 |
| rd_per_employee | 人均研发费用 | 研发费用/员工数 | 研发效率 |

### 8.2 分红和回购（Dividend）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| dividend_per_share | 每股股利 | - | 分红水平 |
| dividend_payout_ratio | 股利支付率 | 股利/净利润 | 分红比例 |
| dividend_yield | 股息率 | 每股股利/股价 | 分红收益 |

### 8.3 员工和效率（Employees）
| 字段名 | 中文名 | 计算公式 | 用途 |
|--------|--------|----------|------|
| employee_count | 员工人数 | - | 规模 |
| revenue_per_employee | 人均营收 | 营收/员工数 | 人效 |
| profit_per_employee | 人均利润 | 净利润/员工数 | 人效 |

---

## 📝 指标提取优先级

### P0：核心必需（15个）
- revenue, net_profit, total_assets, total_liabilities, total_equity
- revenue_yoy, net_profit_yoy, asset_liability_ratio
- roe, gross_margin, net_margin, operating_cash_flow
- pe_ratio, pb_ratio, eps

### P1：重要补充（20个）
- operating_profit, current_assets, current_liabilities, cash_and_equivalents
- current_ratio, quick_ratio, roa, operating_margin
- free_cash_flow, ocf_to_net_profit, asset_turnover
- inventory_turnover, receivable_turnover, cash_conversion_cycle
- revenue_qoq, net_profit_qoq, bps, ps_ratio, peg_ratio, rd_ratio

### P2：交叉计算支持（30+个）
- 所有费用明细
- 资产负债明细项
- 现金流明细
- 周转天数指标
- 增长率指标
- 分红指标

---

## 🔄 交叉计算支持

### 示例1：杜邦分析
```
ROE = 净利率 × 总资产周转率 × 权益乘数
    = (净利润/营收) × (营收/总资产) × (总资产/股东权益)
```

需要字段：net_profit, revenue, total_assets, total_equity

### 示例2：现金转换周期
```
CCC = 存货周转天数 + 应收账款天数 - 应付账款天数
```

需要字段：inventory, accounts_receivable, accounts_payable, revenue, operating_cost

### 示例3：自由现金流
```
FCF = 经营现金流 - 资本支出
```

需要字段：operating_cash_flow, investing_cash_flow（从中提取capex）

### 示例4：企业价值（EV）
```
EV = 市值 + 总负债 - 现金
```

需要字段：market_cap, total_liabilities, cash_and_equivalents

---

## 💾 数据库字段映射

所有字段都映射到 `financial_metrics` 表，使用 `Numeric(20, 2)` 或 `Numeric(10, 4)` 类型。

**扩展策略：**
1. Phase 1 实现 P0 + P1 指标（35个）
2. Phase 2 根据需要补充 P2 指标
3. 预留 `extra_metrics` JSON 字段存储特殊指标

---

## 📊 指标总数统计

| 分类 | P0 | P1 | P2 | 合计 |
|------|----|----|----|----|
| 损益表 | 6 | 8 | 10 | 24 |
| 资产负债表 | 5 | 6 | 12 | 23 |
| 现金流量表 | 1 | 4 | 5 | 10 |
| 盈利能力 | 1 | 3 | 2 | 6 |
| 运营效率 | 0 | 4 | 6 | 10 |
| 估值指标 | 2 | 3 | 2 | 7 |
| 成长性 | 0 | 2 | 4 | 6 |
| 其他 | 0 | 1 | 5 | 6 |
| **合计** | **15** | **31** | **46** | **92** |

**Phase 1 目标：实现 46 个指标（P0 + P1）**

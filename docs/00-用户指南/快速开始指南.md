# 快速开始指南

> **推荐测试流程** - 按此顺序操作，确保所有功能正常工作

## 📚 文档导航

根据您的需求选择对应文档：

| 文档 | 用途 | 适用场景 |
|-----|------|---------|
| **快速开始指南.md**（本文档） | 第一次使用或完整测试 | ⭐ 推荐从这里开始 |
| **测试指南.md** | 详细的测试步骤和检查清单 | 需要全面测试所有功能 |
| **CLI_USAGE.md** | CLI命令详细使用手册 | 日常使用参考 |
| **WARNING问题解决方案.md** | 遇到WARNING错误时 | 故障排查 |
| **问题修复说明.md** | 之前修复的问题汇总 | 了解历史修复 |

---

## 🚀 完整测试流程（推荐）

### Step 1: 清空旧数据（可选但推荐）

```bash
# 如果之前测试过，建议先清空数据库
rm -f data/database.db

# 或者备份旧数据库
cp data/database.db data/database.db.backup.$(date +%Y%m%d)
rm -f data/database.db
```

### Step 2: 初始化测试数据

```bash
# 初始化2-3只股票用于测试
python init_stock_data.py 688005 600519

# 预期输出：
# ✓ 使用 Mock 数据源（模拟数据）
# ✓ 成功初始化 2 只股票
# ✓ 创建了 10 年的财务数据
```

### Step 3: 诊断数据完整性

```bash
# 确保数据完整
python diagnose_and_fix.py 688005 600519

# 预期输出：
# ✓ 所有关键字段完整
# ✓ 所有股票数据完整，无需修复！
```

**如果出现缺失字段**，选择修复选项 `1` 全部修复。

### Step 4: 测试CLI基础功能

```bash
# 4.1 列出可用框架
python stock_analyzer.py list-frameworks

# 预期输出：
# 评分型框架（Scoring）:
#   • value_investing - 价值投资框架
#   • growth_investing - 成长投资框架
# 筛选型框架（Screening）:
#   • quality_stock_screener - 优质白马股筛选框架

# 4.2 查看股票信息
python stock_analyzer.py info 688005

# 预期输出：
# 股票代码: 688005
# 股票名称: 股票688005
# 财务数据: 5 条记录

# 4.3 查看股票信息（贵州茅台）
python stock_analyzer.py info 600519

# 预期输出：
# 股票名称: 贵州茅台
# 行业: 白酒
```

### Step 5: 测试分析功能（评分0-100）

```bash
# 5.1 分析单只股票（详细模式）
python stock_analyzer.py analyze 688005

# 预期输出：
# 总分: 48.0/100
# 评级: 不及格
# 各维度得分表格
# 投资建议

# 5.2 分析单只股票（简化模式）
python stock_analyzer.py analyze 600519 --no-detail

# 预期输出：
# 贵州茅台: 70.0分 (中等)

# 5.3 切换框架分析
python stock_analyzer.py analyze 600519 -f growth_investing

# 预期输出：
# 使用分析框架: growth_investing
# 总分: XX.X/100

# 5.4 批量对比分析
python stock_analyzer.py analyze 688005,600519 --no-detail

# 预期输出：
# 股票688005: 48.0分 (不及格)
# 贵州茅台: 70.0分 (中等)
```

### Step 6: 测试筛选功能（Pass/Fail）

```bash
# 6.1 筛选单只股票（详细模式）
python stock_analyzer.py screen 688005

# 预期输出：
# 筛选结果: FAIL
# 通过率: X.X%
# 各类别详细检查结果
# 未通过条件列表
# 改进建议

# 6.2 筛选单只股票（简化模式）
python stock_analyzer.py screen 600519 --no-detail

# 预期输出：
# ❌ 贵州茅台: FAIL (通过率: 18.8%)

# 6.3 批量筛选
python stock_analyzer.py screen 688005,600519 --no-detail
```

### Step 7: 验证无WARNING（重要）

```bash
# 确保分析过程无警告
python stock_analyzer.py analyze 688005 2>&1 | grep WARNING

# 预期输出：
# （应该没有任何输出）

# 如果有WARNING，请查看：WARNING问题解决方案.md
```

### Step 8: 测试更多股票（可选）

```bash
# 初始化更多股票
python init_stock_data.py 000858 002594 300750

# 批量分析对比
python stock_analyzer.py analyze 688005,600519,000858,002594,300750 --no-detail

# 批量筛选
python stock_analyzer.py screen 688005,600519,000858 -f quality_stock_screener --no-detail
```

---

## ✅ 测试检查清单

完成以下检查确认功能正常：

### 基础功能
- [ ] `init_stock_data.py` 成功初始化股票数据
- [ ] `diagnose_and_fix.py` 显示所有字段完整
- [ ] `list-frameworks` 显示3个框架
- [ ] `info` 命令显示股票信息

### 分析功能
- [ ] `analyze` 命令正常执行
- [ ] 显示总分和评级
- [ ] 显示各维度得分表格
- [ ] 支持 `--no-detail` 简化模式
- [ ] 支持 `-f` 切换框架
- [ ] 支持批量分析（逗号分隔）

### 筛选功能
- [ ] `screen` 命令正常执行
- [ ] 显示 PASS/FAIL 结果
- [ ] 显示通过率百分比
- [ ] 详细模式显示完整报告
- [ ] 简化模式显示一行摘要

### 质量验证
- [ ] 无任何 WARNING 日志
- [ ] 无任何 ERROR 错误
- [ ] 数据诊断显示完整
- [ ] 评分在合理范围（0-100）

---

## 🐛 常见问题快速解决

### 问题1: 出现 WARNING 日志

```bash
# 解决方案：诊断并修复数据
python diagnose_and_fix.py 688005
# 选择修复选项

# 详细说明见：WARNING问题解决方案.md
```

### 问题2: 股票不存在

```bash
# 解决方案：初始化该股票
python init_stock_data.py <股票代码>

# 例如：
python init_stock_data.py 688005
```

### 问题3: 评分异常低或异常高

```bash
# 解决方案：检查数据是否完整
python diagnose_and_fix.py <股票代码>

# 模拟数据的评分范围（参考）：
# - 白酒行业（如600519）: 60-80分
# - 科技/电池（如688005）: 40-60分
# - 成长股框架评分通常更高
```

### 问题4: 命令找不到

```bash
# 确认在正确的目录
pwd
# 应该显示: /home/user/financial_report_scraper

# 检查Python路径
which python
python --version
```

---

## 📊 预期测试结果

### 贵州茅台 (600519) - 白酒行业

**价值投资框架评分**：
```
总分: 70.0/100 (中等)
├─ 盈利能力: 40.0/40.0 (100.0%) ✓ 优秀
├─ 财务稳健: 28.0/30.0 (93.3%)  ✓ 优秀
├─ 护城河:    0.0/20.0 (0.0%)    ✗ 缺少历史数据
└─ 估值:      2.0/10.0 (20.0%)   ✗ 模拟数据
投资建议: 持有/观察
```

**优质股筛选**：
```
结果: FAIL
通过率: 18.8%
主要原因: 缺少增长率数据、分红数据、历史估值数据
```

### 容百科技 (688005) - 电池行业

**价值投资框架评分**：
```
总分: 48.0/100 (不及格)
├─ 盈利能力: 25.0/40.0 (62.5%)  一般
├─ 财务稳健: 21.0/30.0 (70.0%)  良好
├─ 护城河:    0.0/20.0 (0.0%)    ✗ 缺少历史数据
└─ 估值:      2.0/10.0 (20.0%)   ✗ 模拟数据
投资建议: 不推荐
```

**成长投资框架评分**：
```
总分: 约60-70/100 (及格-中等)
适合成长股分析框架
```

### 为什么护城河得分是0？

模拟数据缺少以下派生指标：
- `roe_consistency`: ROE连续性（需要历史趋势分析）
- `gross_margin_stability`: 毛利率波动率（需要标准差计算）
- `market_position`: 市场地位（需要人工标注）

**解决方案**：
1. 使用真实财报数据（Phase 1 PDF解析）
2. 或实现这些派生指标的计算逻辑

---

## 🎯 下一步行动

### 如果测试全部通过

恭喜！系统工作正常。您可以：

1. **添加更多股票**
   ```bash
   python init_stock_data.py <更多股票代码>
   ```

2. **自定义分析框架**
   - 编辑 `config/frameworks/*.yaml`
   - 调整权重、阈值、评分规则

3. **使用真实数据**
   ```bash
   # 安装AkShare
   pip install akshare

   # 重新初始化（自动使用真实信息）
   python init_stock_data.py 688005
   ```

4. **批量分析股票池**
   ```bash
   # 创建股票池文件
   echo "688005 600519 000858 002594" > stock_pool.txt

   # 批量分析
   cat stock_pool.txt | xargs python stock_analyzer.py analyze --no-detail
   ```

### 如果遇到问题

请查看对应文档：

1. **WARNING错误** → `WARNING问题解决方案.md`
2. **数据缺失** → `问题修复说明.md`
3. **功能疑问** → `CLI_USAGE.md`
4. **全面测试** → `测试指南.md`

---

## 📞 获取帮助

如果问题仍未解决，请提供以下信息：

```bash
# 1. 诊断报告
python diagnose_and_fix.py 688005 > diagnostic.txt

# 2. 完整日志
python stock_analyzer.py analyze 688005 > analysis.log 2>&1

# 3. 系统信息
python --version > sysinfo.txt
pip list | grep -E "(rich|click|sqlalchemy)" >> sysinfo.txt
```

将以上3个文件一起反馈。

---

## 🎓 学习资源

- **配置文件位置**: `config/frameworks/*.yaml`
- **数据源代码**: `src/data_sources/`
- **分析引擎**: `src/analyzers/framework_engine.py`
- **筛选引擎**: `src/analyzers/screening_engine.py`
- **数据库模型**: `src/database/models.py`

---

**祝测试顺利！** 🚀
